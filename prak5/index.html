<!-- 
   Nama  : Ahmad Dwiky Zerro Dixxon
   NIM   : 121140044
   Kelas : RB
 -->


 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prak5</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="./icon.png" type="image/x-icon">
 
 </head>
 <body>

   <audio id="audio" loop>
      <source src="interstellar.mp3" type="audio/mp3" />
      Your browser does not support the audio element.
   </audio>
    
   <div class="bg"></div>

   <div class="star-field">
   <div class="layer"></div>
   <div class="layer"></div>
   <div class="layer"></div>
 
   <main>
      <section>
         <form>
           <div class="display">
             <input id="screen" type="text">
           </div>
           <div>
             <input type="button" value="AC" onclick="opPad('clr')" class="operator">
             <input type="button" value="DE" onclick="opPad('del')" class="operator">
             <input type="button" value="." onclick="opPad('dot')" class="operator">
             <input type="button" value="/" onclick="opPad('/')" class="operator">
           </div>
           <div>
             <input type="button" value="7" onclick="numPad('7')">
             <input type="button" value="8" onclick="numPad('8')">
             <input type="button" value="9" onclick="numPad('9')">
             <input type="button" value="x" onclick="opPad('x')" class="operator">
           </div>
           <div>
             <input type="button" value="4" onclick="numPad('4')">
             <input type="button" value="5" onclick="numPad('5')">
             <input type="button" value="6" onclick="numPad('6')">
             <input type="button" value="-" onclick="opPad('-')" class="operator">
           </div>
           <div>
             <input type="button" value="1" onclick="numPad('1')">
             <input type="button" value="2" onclick="numPad('2')">
             <input type="button" value="3" onclick="numPad('3')">
             <input type="button" value="+" onclick="opPad('+')" class="operator">
           </div>
           <div>
             <input type="button" value="00" onclick="numPad('00')">
             <input type="button" value="0" onclick="numPad('0')">
             <input type="button" value="=" onclick="opPad('=')" class="equal operator">
            
           </div>
         </form>
      </section>
   </main>
 
    <script> 

      document.addEventListener('DOMContentLoaded', function() {
         let audio = document.getElementById('audio');
         audio.play();
      });

      displaying('0');
      function getScreen(){
         let screen = document.getElementById('screen').value.toString();
         if(screen == "0" ){ return ''; }
         
        return screen;
      }

      function displaying(value){
         document.getElementById('screen').value = value;
      }

      function isScreenEmpty(){
         return getScreen() == '';
      }

      function isOnOperator(){
         return "/x-+".includes(getScreen().charAt(getScreen().length-1));
      }

      function operation(operator){
         let op = operator.toString()

         if(!isOnOperator()){
               displaying(getScreen()+op);
            }
            else{
               displaying(getScreen().slice(0, -1)); 
               displaying(getScreen()+op);
            }
      }

      function equal(){
         let screen = getScreen().split(/(\/|\x|\-|\+)/);
         let result = 0;

         for(let i=0; i<screen.length; i++){

            if(i == 0){ result = parseFloat(screen[i]); }

            num = parseFloat(screen[i+1])
            if(screen[i] == '/'){
               result /= num;
            }
            else if(screen[i] == 'x'){
               result *= num;
            }
            else if(screen[i] == '-'){
               result -= num;
            }
            else if(screen[i] == '+'){
               result += num;
            }
         }

         return result;
      }

      function numPad(num){
         displaying(getScreen()+num);
      }

      function opPad(type){

         if(type == 'clr'){
            displaying('0');
         }
         else if(type == 'del'){
            if(!isScreenEmpty()){ displaying(getScreen().slice(0, -1)); }
         }
         else if(type == 'dot'){
            (isScreenEmpty()) ? displaying(getScreen()+"0.") : displaying(getScreen()+".");
         }
         else if(type == '='){
           if(isOnOperator()){
            alert('Cannot end with operator, please try again!');
           }
           else{
            displaying(equal());
           }
         }


         if(type == '/' ){
            operation('/');
         }
         else if(type == 'x'){
            operation('x');
         }
         else if(type == '-'){
            operation('-');
         }
         else if(type == '+'){
            operation('+');
         }
         
      }

    </script>
 
 </body>
 </html>